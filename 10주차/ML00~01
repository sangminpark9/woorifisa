# 10ì£¼ì°¨

# ML00

## Box flot
```python
q1 = np.percentile(df.length, 25)
q3 = np.percentile(df.length, 75)
iqr = (q3 - q1)
# ì ˆì‚¬í‰ê·  : max, minì„ êµ¬í•´ë³´ì‹œê³  í˜„ì¬ ë„ë¯¸ì˜ ê¸¸ì´ ë°ì´í„°ì—ëŠ” outlier(ì´ìƒì¹˜)ê°€ ìˆëŠ”ì§€ ì§ì ‘ í™•ì¸í•´ë³´ì„¸ìš”
min_ = q1 - 1.5*iqr
max_ = q3 + 1.5*iqr
print(min_, max_)
filtered_df = df[(min_ < df['length']) & (df['length'] < max_)]
```


## ë³µì›ì¶”ì¶œ / ë¹„ë³µì›ì¶”ì¶œ

```python
# 'ì‚¬ê±´' : íŠ¹ì •í•œ ì¼ì´ ë°œìƒí•˜ê²Œ ë§Œë“œëŠ” í–‰ìœ„
# ë³µì›ì¶”ì¶œ - ë…ë¦½ì‚¬ê±´
a = np.random.choice(df.length, size=20)   # í•œ ë²ˆ ë¬¼ê³ ê¸°ë¥¼ êº¼ë‚´ê³  ë‹¤ì‹œ ëŒë ¤ë†“ê³  ë‹¤ìŒ ë¬¼ê³ ê¸°ë¥¼ ë½‘ëŠ” ê²½ìš°
```

```python
df.length[:20]
```

```python
# ì¢…ì†ì‚¬ê±´ : ë¨¼ì € ì¼ì–´ë‚œ ì¼ì´ ë‹¤ìŒì— ì¼ì–´ë‚œ ì¼ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì‚¬ê±´
# ë¹„ë³µì›ì¶”ì¶œ
b = np.random.choice(df.length, size=20, replace=False)   # í•œ ë²ˆ ë¬¼ê³ ê¸°ë¥¼ êº¼ë‚´ê³  ê·¸ ë¬¼ê³ ê¸°ëŠ” ì œì™¸í•˜ê³  ë‹¤ìŒ ë¬¼ê³ ê¸°ë¥¼ ë½‘ëŠ” ê²½ìš°
```


# ì´í•­ë¶„í¬(binom distribution)
* ë² ë¥´ëˆ„ì´ ì‹œí–‰ì„ ì—¬ëŸ¬ë²ˆ í–ˆì„ ê²½ìš°ì˜ ë¶„í¬
* ì£¼ì‚¬ìœ„ë¥¼ 10ë²ˆ ë˜ì¡Œì„ ë•Œ 1ì´ ë‚˜ì˜¤ëŠ” ê²½ìš°ë¥¼ ì„±ê³µì´ë¼ê³  ê°€ì •

```python
x = [0, 1] # ì‹¤íŒ¨, ì„±ê³µ
# 1ê³¼ 1ì´ ì•„ë‹ í™•ë¥  ì„±ê³µ, ì‹¤íŒ¨
rv = binom(10, 1/6)  # í™•ë¥ ì´ 1/6ì¸ ì‚¬ê±´ì„ 10ë²ˆ ì‹œí–‰í–ˆì„ ë•Œ ì‹¤íŒ¨ / ì„±ê³µ í™•ë¥ 
rv.pmf(x)
```


# ML01

1. ë¨¸ì‹ ëŸ¬ë‹ì˜ êµ¬ë¶„
![image](https://github.com/user-attachments/assets/70f9a951-bfaf-437b-a155-93c073dbae70)

~https://github.com/trekhleb/homemade-machine-learning~


2. teachable machine

<img width="765" alt="image" src="https://github.com/user-attachments/assets/31fad07e-6ae5-44b3-b77b-6ac596647289">

Teachable Machineì—ì„œ ì‚¬ìš©ë˜ëŠ” ì—í¬í¬, ë°°ì¹˜ í¬ê¸°, í•™ìŠµë¥ ì€ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í›ˆë ¨í•  ë•Œ ì¤‘ìš”í•œ í•˜ì´í¼íŒŒë¼ë¯¸í„°ì…ë‹ˆë‹¤.
| **í•˜ì´í¼íŒŒë¼ë¯¸í„°** | **ì •ì˜** | **íŠ¹ì§•** | **ì˜ˆì‹œ** |
|:-:|:-:|:-:|:-:|
| ì—í¬í¬(Epoch) | ì „ì²´ ë°ì´í„°ì…‹ì„ í•œ ë²ˆ ì™„ì „íˆ í†µê³¼í•˜ëŠ” í•™ìŠµ ì£¼ê¸° | - ë§ì„ìˆ˜ë¡ ë” ë§ì´ í•™ìŠµ<br>- ê³¼ì í•© ìœ„í—˜ ìˆìŒ | 100ê°œ ì´ë¯¸ì§€, 10 ì—í¬í¬ = ëª¨ë“  ì´ë¯¸ì§€ 10ë²ˆ ë°˜ë³µ í•™ìŠµ |
| ë°°ì¹˜ í¬ê¸°(Batch Size) | í•œ ë²ˆì— ì²˜ë¦¬ë˜ëŠ” ë°ì´í„° ìƒ˜í”Œì˜ ìˆ˜ | - í° ë°°ì¹˜: ë¹ ë¥¸ í•™ìŠµ, ë§ì€ ë©”ëª¨ë¦¬ ì‚¬ìš©<br>- ì‘ì€ ë°°ì¹˜: ëŠë¦° í•™ìŠµ, ì ì€ ë©”ëª¨ë¦¬ ì‚¬ìš© | ë°°ì¹˜ í¬ê¸° 32 = 32ê°œ ì´ë¯¸ì§€ ë™ì‹œ ì²˜ë¦¬ |
| í•™ìŠµë¥ (Learning Rate) | ê° í•™ìŠµ ë‹¨ê³„ì—ì„œ ê°€ì¤‘ì¹˜ ì¡°ì • ì •ë„ | - í° í•™ìŠµë¥ : ë¹ ë¥¸ í•™ìŠµ, ìµœì ì  ë†“ì¹  ìˆ˜ ìˆìŒ<br>- ì‘ì€ í•™ìŠµë¥ : ì•ˆì •ì  í•™ìŠµ, ì‹œê°„ ì˜¤ë˜ ê±¸ë¦¼ | (ìˆ˜ì¹˜ì  ì˜ˆì‹œ ì—†ìŒ) |

```python
import os
import shutil
import re

TARGET_DIR = "/Users/sangmin/Desktop/09_ML/test"

def organize_files():
    pattern = re.compile(r'(\d[LR])\.png$')
    
    # ëª¨ë“  ê°€ëŠ¥í•œ ë””ë ‰í† ë¦¬ ì´ë¦„ ë¦¬ìŠ¤íŠ¸
    directories = ['5L', '4L', '3L', '2L', '1L', '0L', '5R', '4R', '3R', '2R', '1R', '0R']
    
    # ë””ë ‰í† ë¦¬ê°€ ì—†ìœ¼ë©´ ìƒì„±
    for dir_name in directories:
        dir_path = os.path.join(TARGET_DIR, dir_name)
        if not os.path.exists(dir_path):
            os.makedirs(dir_path)
            print(f"Created directory: {dir_path}")

    # TARGET_DIRì˜ ëª¨ë“  íŒŒì¼ì„ ê²€ì‚¬
    for filename in os.listdir(TARGET_DIR):
        if filename.endswith('.png'):
            match = pattern.search(filename)
            if match:
                dir_name = match.group(1)
                if dir_name in directories:
                    source_path = os.path.join(TARGET_DIR, filename)
                    target_dir = os.path.join(TARGET_DIR, dir_name)
                    target_path = os.path.join(target_dir, filename)
                    
                    # íŒŒì¼ ì´ë™
                    shutil.move(source_path, target_path)
                    print(f"Moved {filename} to {target_dir}/")
                else:
                    print(f"Skipped {filename}: No matching directory")
            else:
                print(f"Skipped {filename}: Doesn't match the pattern")

if __name__ == "__main__":
    organize_files()
    print("File organization complete.")
```

> test set ë¶„ë¥˜ ì½”ë“œ

# streamlit code
```python
import streamlit as st
import numpy as np
from PIL import Image, ImageOps
import tensorflow as tf
import os

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(page_title="ì†ê¾¸ë½ íŒë³„ê¸°", page_icon="ğŸ‘‹", layout="wide")

# CSSë¥¼ ì‚¬ìš©í•œ ìŠ¤íƒ€ì¼ë§
st.markdown("""
<style>
.big-font {
    font-size:30px !important;
    font-weight: bold;
    color: #1E88E5;
}
.result-font {
    font-size:24px !important;
    font-weight: bold;
    color: #4CAF50;
}
.stProgress > div > div > div > div {
    background-color: #1E88E5;
}
</style>
""", unsafe_allow_html=True)

# í˜„ì¬ ìŠ¤í¬ë¦½íŠ¸ì˜ ë””ë ‰í† ë¦¬ ê²½ë¡œ
current_dir = os.path.dirname(os.path.abspath(__file__))

# Disable scientific notation for clarity
np.set_printoptions(suppress=True)

# ì‚¬ìš©ì ì •ì˜ ê°ì²´ ì •ì˜
class CustomDepthwiseConv2D(tf.keras.layers.DepthwiseConv2D):
    def __init__(self, *args, **kwargs):
        if 'groups' in kwargs:
            del kwargs['groups']
        super().__init__(*args, **kwargs)

# ì‚¬ìš©ì ì •ì˜ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ ë¡œë“œ
@st.cache_resource
def load_model_with_custom_objects(model_path):
    return tf.keras.models.load_model(model_path, custom_objects={'DepthwiseConv2D': CustomDepthwiseConv2D}, compile=False)

# Load the model
model_path = os.path.join(current_dir, "keras_Model.h5")
if not os.path.exists(model_path):
    st.error(f"ëª¨ë¸ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {model_path}")
    st.stop()

try:
    model = load_model_with_custom_objects(model_path)
except Exception as e:
    st.error(f"ëª¨ë¸ ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}")
    st.stop()

# Load the labels
labels_path = os.path.join(current_dir, "labels.txt")
if not os.path.exists(labels_path):
    st.error(f"ë ˆì´ë¸” íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {labels_path}")
    st.stop()

class_names = open(labels_path, "r").readlines()

# ì´ë¯¸ì§€ ì „ì²˜ë¦¬
def preprocess_image(image):
    size = (224, 224)
    image = ImageOps.fit(image, size, Image.Resampling.LANCZOS)
    image_array = np.asarray(image)
    normalized_image_array = (image_array.astype(np.float32) / 127.5) - 1
    data = np.ndarray(shape=(1, 224, 224, 3), dtype=np.float32)
    data[0] = normalized_image_array
    return data

# ì˜ˆì¸¡
def predict(img):
    preprocessed_img = preprocess_image(img)
    prediction = model.predict(preprocessed_img)
    index = np.argmax(prediction)
    class_name = class_names[index]
    confidence_score = prediction[0][index]
    return class_name[2:].strip(), confidence_score

# Streamlit ì•±
def main():
    st.markdown('<p class="big-font">ğŸ‘‹ ì†ê¾¸ë½ íŒë³„ê¸°</p>', unsafe_allow_html=True)
    st.write("AIê°€ ë‹¹ì‹ ì˜ ì† ì œìŠ¤ì²˜ë¥¼ ì¸ì‹í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•´ë³´ì„¸ìš”!")

    uploaded_file = st.file_uploader("ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”", type=["jpg", "jpeg", "png"])

    if uploaded_file is not None:
        with st.spinner('ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘...'):
            image = Image.open(uploaded_file).convert('RGB')
            
            col1, col2 = st.columns(2)
            with col1:
                st.image(image, caption='ì—…ë¡œë“œëœ ì´ë¯¸ì§€', use_column_width=True)
            
            with col2:
                # ì˜ˆì¸¡
                result, confidence = predict(image)
                st.markdown(f'<p class="result-font">ì¸ì‹ëœ ì†ê°€ë½ ìˆ«ì: {result}</p>', unsafe_allow_html=True)
                st.write(f"ì‹ ë¢°ë„: {confidence:.2f}")
                
                # í”„ë¡œê·¸ë ˆìŠ¤ ë°”ë¡œ ì‹ ë¢°ë„ í‘œì‹œ
                st.progress(float(confidence))
                
                # ê²°ê³¼ì— ë”°ë¥¸ ì´ëª¨ì§€ í‘œì‹œ
                if confidence > 0.8:
                    st.success("ë†’ì€ ì‹ ë¢°ë„ë¡œ ì¸ì‹ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‘")
                elif confidence > 0.5:
                    st.warning("ì¤‘ê°„ ì •ë„ì˜ ì‹ ë¢°ë„ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”. ğŸ¤”")
                else:
                    st.error("ë‚®ì€ ì‹ ë¢°ë„ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì´ë¯¸ì§€ë¡œ ì‹œë„í•´ë³´ì„¸ìš”. ğŸ˜•")

    st.markdown("---")
    st.write("Â© 2024 ì†ê¾¸ë½ íŒë³„ê¸° | ì œì‘: ì§€ìƒí•˜")

if __name__ == "__main__":
    main()

```

<img width="1327" alt="image" src="https://github.com/user-attachments/assets/4d3e2873-45f8-4f43-adc2-66552548e9fe">
